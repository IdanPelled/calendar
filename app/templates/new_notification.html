{% extends "./partials/base.html" %}
{% block head %}
  {{super()}}

  <!-- CSS -->
  <link rel="stylesheet" type="text/css" href="{{ url_for('static', path='/grid_style.css') }}">
  <link rel="stylesheet" type="text/css" href="{{ url_for('static', path='/notification.css') }}" >

{% endblock head %}
{% block page_name %}Month View{% endblock page_name %}
{% block body %}
  <div class="pyldr-container">
    {% include 'partials/calendar/navigation.html' %}
    <div id="feature-settings">
      {% include 'partials/calendar/feature_settings/example.html' %}
    </div>
    <div class="content">
      {% block content %}
        <header>
            <div>
                <div class="title">New Notifications</div>
                <p class="s-paragraph">
                    In this page you can view all of your new notifications.<br/>
                    use the <button class="notification-btn btn-read"><ion-icon class="icon" name="eye-outline"></ion-icon></button>
                    button to mark as read
                    and the <button class="notification-btn btn-accept"><ion-icon class="icon" name="checkmark-outline"></ion-icon></button>
                    and <button class="notification-btn btn-decline"><ion-icon class="icon" name="close-outline"></ion-icon></button>
                    to accept and decline.
                </p>
            </div>
            <div id="logo-div">
                <a href="/calendar/month">
                    <span class="title">PYLENDAR</span>
                </a>
            </div>
        </header>
        <div id="main">
            <div><a href="{{ url_for('view_old_notifications') }}">Historical notifications</a></div>
            {% if notifications %}
            <div id="notifications-box">
                <form action="{{ url_for('mark_all_as_read') }}" method="post">
                    <input type="hidden" name="next" value="/notification">
                    <button type="submit" class="btn btn-light btn-outline-primary btn-sm"
                    {% if not new_messages %}disabled{% endif %} id="mark-all-ass-read">
                        Mark all as read
                    </button>
                </form>
                <div id="notifications">
                    {% for n in notifications %}
                        {% set type = n.__table__.name %}

                        <div class="notification" id="{{ loop.index }}">
                            {% if type == "invitations" %}
                                <div class="description">
                                    <span>Invitation from {{ n.event.owner.username }} - </span>
                                    <a href="#">{{ n.event.title }}</a>
                                    <span>({{ n.event.start.strftime('%H:%M %m/%d/%Y') }})</span>
                                </div>
                                <div class="action">
                                    <form action="{{ url_for('accept_invitations') }}" method="post"
                                      class="notification-form">
                                        <input type="hidden" name="next" value="/notification">
                                        <button type="submit" name="invite_id" value="{{ n.id }}" class="notification-btn btn-accept">
                                            <ion-icon class="icon" name="checkmark-outline"></ion-icon>
                                        </button>
                                    </form>
                                    <form action="{{ url_for('decline_invitations') }}" method="post"
                                          class="notification-form">
                                         <input type="hidden" name="next" value="/notification">
                                        <button type="submit" name="invite_id" value="{{ n.id }}" class="notification-btn btn-decline">
                                            <ion-icon class="icon" name="close-outline"></ion-icon>
                                        </button>
                                    </form>
                                </div>

                            {% elif type == "messages" %}
                                <div class="description">
                                    {% if n.link %}<a href="{{ n.link }}">{{ n.body }}</a>
                                    {% else %}<span>{{ n.body }}</span>{% endif %}
                                </div>
                                <div class="action">
                                    <form action="{{ url_for('mark_message_as_read') }}" method="post"
                                      class="notification-form mark_as_read">
                                        <input type="hidden" name="next" value="/notification">
                                        <button type="submit" name="message_id" value="{{ n.id }}" class="notification-btn btn-read">
                                            <ion-icon class="icon" name="eye-outline"></ion-icon>
                                        </button>
                                    </form>
                                </div>
                            {% endif %}

                        </div>
                    {% endfor %}
                </div>

            {% else %}
                <span>You don't have any new notifications.</span>
            </div>
            {% endif %}
        </div>
      {% endblock content %}
    </div>
  </div>

  <!-- Scripts -->
  <script src="{{ url_for('static', path='/js/grid_scripts.js') }}"></script>
  <script src="{{ url_for('static', path='/js/grid_navigation.js') }}"></script>
{% endblock body %}